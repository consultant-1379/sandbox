{"paragraphs":[{"title":"Streaming correlation tutorial","text":"This tutorial steps you through creating avro schema, installing schemas, preparing data source and running application to achieve the streaming correlation. Please login into the sandbox and follow the instruction in this note.\n\nIt is originated from the how-to series provided by Liam Fallon. Please check the AIA development blog http://analytics.ericsson.se:23307/2016/11/22/streaming-and-batch-correlation-how-to-guide/ for reference. ","dateUpdated":"2016-11-24T17:26:24-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":false,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480005397087_-1333249687","id":"20161124-113637_1262068968","dateCreated":"2016-11-24T11:36:37-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3062"},{"title":"Log in sandbox","text":"ssh -i <keypair file> cloud-user@<sandbox IP address>","dateUpdated":"2016-11-24T17:26:24-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":false,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480005697524_-1811094141","id":"20161124-114137_1121847309","result":{"code":"ERROR","type":"TEXT","msg":""},"dateCreated":"2016-11-24T11:41:37-0500","dateStarted":"2016-11-24T11:45:46-0500","dateFinished":"2016-11-24T11:45:52-0500","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3063"},{"title":"Prepartion","text":"Check directory /home/cloud-user/example for the aia-support folder, please clone the project with your signum if it doesn't exist,\n\n    git clone ssh://<signum>@gerrit.ericsson.se:29418/com.ericsson.nmlab/aia-support\n\nNOTE: you need permission to access the git repo and also need to configure the public key in gerrit.\n\nCheck directory /home/cloud-user/example for the model folder, please clone the project with your signum and change to branch dVersionAttribute_with_pojo if the folder doesn't exist,\n\n    git clone ssh://<signum>@gerrit.ericsson.se:29418/AIA/model\n    cd model\n    git checkout dVersionAttribute_with_pojo\n    \n","dateUpdated":"2016-11-24T17:26:24-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":false,"title":true,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480005946509_2110249680","id":"20161124-114546_1061135656","dateCreated":"2016-11-24T11:45:46-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3064"},{"title":"Project Build","text":"Build the model project first,\n\n    cd /home/cloud-user/example/model\n    mvn clean install\n    \nBuild the aia-support project,\n\nChange the kafka-clients dependency version from 0.10.0.x to 0.9.0.0 in the following pom files\n\n    /home/cloud-user/example/aia-support/aia-support.datasink/pom.xml\n    /home/cloud-user/example/aia-support/aia-support.csv-datasource/pom.xml\n\nRun the following command to build the whole project. -DinstallSchemas is used to install the generated avro schema to schema registry.\n\n    cd /home/cloud-user/example/aia-support\n    mvn clean install -DinstallSchemas","dateUpdated":"2016-11-24T17:26:24-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":false,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480010080058_948760028","id":"20161124-125440_1990368102","dateCreated":"2016-11-24T12:54:40-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3065"},{"title":"AVRO schema","text":"Run the following command to make sure all the schemas are installed successfully\n\ncurl http://localhost:8081/subjects/correlation.SALES_EVENT/versions/latest\ncurl http://localhost:8081/subjects/correlation.SALES_INPUT/versions/latest\ncurl http://localhost:8081/subjects/correlation.BRANCH_INPUT/versions/latest\ncurl http://localhost:8081/subjects/correlation.ITEMS_INPUT/versions/latest\ncurl http://localhost:8081/subjects/correlation.ASSISTANT_INPUT/versions/latest","dateUpdated":"2016-11-24T17:26:24-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":false,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480007414285_-572168222","id":"20161124-121014_776872561","dateCreated":"2016-11-24T12:10:14-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3066"},{"title":"Run the correlation","text":"Replace the <IP Address> with sandbox IP address in the following command and run it\n\n    export SPARK_HOME=/usr/lib/spark/\n    cd /home/cloud-user/example/aia-support\n    bin/runCorrelation.sh http://localhost:8081 spark://<IP Address>:7077 aia-support.sample-streaming-correlation\n    \n","dateUpdated":"2016-11-24T17:26:24-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":false,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480008718661_-1863343968","id":"20161124-123158_1305004017","dateCreated":"2016-11-24T12:31:58-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3067"},{"title":"Run the data sink","text":"Open a new connection to the sandbox and run the following command to subscribe to correlation output\n\n    cd /home/cloud-user/example/aia-support\n    bin/runEventSink.sh localhost:9092 http://localhost:8081 SALES_OUTPUT","dateUpdated":"2016-11-24T17:26:24-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":false,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480009490655_666126118","id":"20161124-124450_971612336","dateCreated":"2016-11-24T12:44:50-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3068"},{"title":"Run the data source","text":"Open a new connection to the sandbox and run the following command to generate traffic and public into kafka\n\n    cd /home/cloud-user/example/aia-support\n    bin/runCSVInputGeneration.sh localhost:9092 http://localhost:8081","dateUpdated":"2016-11-24T17:26:24-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":false,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480010218619_1055551657","id":"20161124-125658_488771606","dateCreated":"2016-11-24T12:56:58-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3069"},{"title":"Expected Result","text":"in corrleation console, should be able to see the following output,\n\n2016-11-24 17:15:26 INFO  SampleCorrelation:300 - ,12303702,8585.74,3455634,435,33,\"Vladivostok\",\"\",3455634,\"Bed\",96.78,123123,13325,\"Furniture\",33,\"Yamada\",\"Taro\",\"Nanno\",34,3,892344333,\"Vladivostok\",7884,\"Main\",\"Admiral Yumasheva Street\",\"Vladivostok\",\"Russian Federation\",\"690000\"\n2016-11-24 17:15:26 INFO  SampleCorrelation:300 - ,13408764,55.0,1232,45,1222,\"Vladivostok\",\"\",1232,\"Table and Chairs\",122.34,233454432,12452,\"Furniture\",1222,\"Citizen\",\"Sean\",\"Tadhg\",23,3,871234321,\"Vladivostok\",7884,\"Main\",\"Admiral Yumasheva Street\",\"Vladivostok\",\"Russian Federation\",\"690000\"\n2016-11-24 17:15:26 INFO  SampleCorrelation:300 - ,37720128,966.37,1232,2,1222,\"Vladivostok\",\"\",1232,\"Table and Chairs\",122.34,233454432,12452,\"Furniture\",1222,\"Citizen\",\"Sean\",\"Tadhg\",23,3,871234321,\"Vladivostok\",7884,\"Main\",\"Admiral Yumasheva Street\",\"Vladivostok\",\"Russian Federation\",\"690000\"\n2016-11-24 17:15:26 INFO  SampleCorrelation:300 - ,25564446,2722.88,16775645,5,22,\"Vladivostok\",\"\",16775645,\"Marlboro Lights\",2.25,13215321,2332,\"Tobacco\",22,\"Bloggs\",\"Joe\",\"John\",19,3,839877654,\"Vladivostok\",7884,\"Main\",\"Admiral Yumasheva Street\",\"Vladivostok\",\"Russian Federation\",\"690000\"\n2016-11-24 17:15:26 INFO  SampleCorrelation:300 - ,49875810,8555.6,16775645,3131,343,\"Vladivostok\",\"\",16775645,\"Marlboro Lights\",2.25,13215321,2332,\"Tobacco\",343,\"Mustermann\",\"Max\",\"Fritz\",21,2,887655432,\"Vladivostok\",7884,\"Main\",\"Admiral Yumasheva Street\",\"Vladivostok\",\"Russian Federation\",\"690000\"\n\n\nIn data sink console, expect the following output,\n\n2016-11-24 17:15:27 INFO  DefaultAsyncSchemaRegistry:45 - Schema Registry ADDRESS: -DschemaRegistry.address=[http://localhost:8081]\nRecord no:0, AIA event id=0, value= {\"_NE\": \"\", \"_TIMESTAMP\": 0, \"_ID\": 0, \"_VERSION\": \"\", \"SALES_TRANSACTION_SALE_ID\": 43245438, \"SALES_TRANSACTION_AMOUNT\": 455.17, \"SALES_TRANSACTION_ITEM_ID\": 1232, \"SALES_TRANSACTION_QUANTITY\": 1, \"SALES_TRANSACTION_ASSISTANT_ID\": 33, \"SALES_TRANSACTION_BRANCH_NAME\": \"Al Raqqah\", \"SALES_TRANSACTION_NOTES\": \"\", \"ITEM_DETAILS_ITEM_ID\": 1232, \"ITEM_DETAILS_DESCRIPTION\": \"Table and Chairs\", \"ITEM_DETAILS_COST_PRICE\": 122.34, \"ITEM_DETAILS_BARCODE\": 233454432, \"ITEM_DETAILS_SUPPLIER_ID\": 12452, \"ITEM_DETAILS_CATEGORY\": \"Furniture\", \"ASSISTANT_DETAILS_ASSISTANT_ID\": 33, \"ASSISTANT_DETAILS_SURNAME\": \"Yamada\", \"ASSISTANT_DETAILS_FIRSTNAME\": \"Taro\", \"ASSISTANT_DETAILS_MIDDLENAME\": \"Nanno\", \"ASSISTANT_DETAILS_AGE\": 34, \"ASSISTANT_DETAILS_GRADE\": 3, \"ASSISTANT_DETAILS_PHONE_NO\": 892344333, \"BRANCH_DETAILS_BRANCH_NAME\": \"Al Raqqah\", \"BRANCH_DETAILS_BRANCH_ID\": 5667, \"BRANCH_DETAILS_BRANCH_CATEGORY\": \"Main\", \"BRANCH_DETAILS_STREET\": \"7 April Park\", \"BRANCH_DETAILS_CITY\": \"Al Raqqa\", \"BRANCH_DETAILS_COUNTRY\": \"Syria\", \"BRANCH_DETAILS_POSTCODE\": \"SY.RA.RA\"}\nRecord no:1, AIA event id=0, value= {\"_NE\": \"\", \"_TIMESTAMP\": 0, \"_ID\": 0, \"_VERSION\": \"\", \"SALES_TRANSACTION_SALE_ID\": 14513826, \"SALES_TRANSACTION_AMOUNT\": 955.0, \"SALES_TRANSACTION_ITEM_ID\": 16775645, \"SALES_TRANSACTION_QUANTITY\": 2, \"SALES_TRANSACTION_ASSISTANT_ID\": 33, \"SALES_TRANSACTION_BRANCH_NAME\": \"Pyongyang\", \"SALES_TRANSACTION_NOTES\": \"\", \"ITEM_DETAILS_ITEM_ID\": 16775645, \"ITEM_DETAILS_DESCRIPTION\": \"Marlboro Lights\", \"ITEM_DETAILS_COST_PRICE\": 2.25, \"ITEM_DETAILS_BARCODE\": 13215321, \"ITEM_DETAILS_SUPPLIER_ID\": 2332, \"ITEM_DETAILS_CATEGORY\": \"Tobacco\", \"ASSISTANT_DETAILS_ASSISTANT_ID\": 33, \"ASSISTANT_DETAILS_SURNAME\": \"Yamada\", \"ASSISTANT_DETAILS_FIRSTNAME\": \"Taro\", \"ASSISTANT_DETAILS_MIDDLENAME\": \"Nanno\", \"ASSISTANT_DETAILS_AGE\": 34, \"ASSISTANT_DETAILS_GRADE\": 3, \"ASSISTANT_DETAILS_PHONE_NO\": 892344333, \"BRANCH_DETAILS_BRANCH_NAME\": \"Pyongyang\", \"BRANCH_DETAILS_BRANCH_ID\": 3233, \"BRANCH_DETAILS_BRANCH_CATEGORY\": \"Sub\", \"BRANCH_DETAILS_STREET\": \"Sungri Street\", \"BRANCH_DETAILS_CITY\": \"Pyongyang\", \"BRANCH_DETAILS_COUNTRY\": \"Korea\", \"BRANCH_DETAILS_POSTCODE\": \"23060\"}\n","dateUpdated":"2016-11-24T17:26:24-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":false,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480025802403_-218055253","id":"20161124-171642_786229934","dateCreated":"2016-11-24T17:16:42-0500","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:3070"},{"text":"","dateUpdated":"2016-11-24T17:26:24-0500","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":false,"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1480025797636_372903733","id":"20161124-171637_1324067024","result":{"code":"ERROR","type":"TEXT","msg":""},"dateCreated":"2016-11-24T17:16:37-0500","dateStarted":"2016-11-24T17:26:13-0500","dateFinished":"2016-11-24T17:26:19-0500","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:3071"}],"name":"BPS based streaming correlation","id":"2C21ZCSR8","angularObjects":{"2C28SRPHR:shared_process":[],"2BZVK82HU:shared_process":[],"2C2WWHDX5:shared_process":[],"2C1AB9NGZ:shared_process":[],"2BZYXDBWV:shared_process":[],"2C33K6QH8:shared_process":[],"2C37AUD79:shared_process":[],"2C2CUPZCP:shared_process":[],"2C14WP1EG:shared_process":[],"2BZF1VUDC:shared_process":[],"2C37NMVGZ:shared_process":[],"2C2UZNMPK:shared_process":[],"2C33HXU75:shared_process":[],"2C41CQSTT:shared_process":[],"2C3HVUNT4:shared_process":[],"2C1T3P5DN:shared_process":[],"2BZVJCNJU:shared_process":[],"2C1AP3V9G:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}